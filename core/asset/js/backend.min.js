/**
 * Ce fichier "init.js" est obligatoire et son nom est très important pour faire fonctionné la lib JS de EO-Framework.
 *
 * Elle permet d'initialisé un sous objet dans l'objet eoxiaJS.
 * Tout plugin utilisant EO-Framework doit initialiser ce sous objet.
 *
 * Tous vos modules doivent déclarer un sous-sous objet pour être utiliser.
 * @see /module/hello-world/asset/js/hello-world.backend.js
 *
 * Cette façon de faire permet d'éviter tout conflit entre différent plugin. Il faut considérer que cette méthode
 * permet de gérer vos JS dans un namespace ou aucun plugin pourra rentrer en conflit.
 *
 * Prenons comme exemple le plugin TaskManager et DigiRisk; Voici leurs namespace:
 *
 * window.eoxiaJS.TaskManager
 * window.eoxiaJS.digiRisk
 *
 * Ensuite sous ses namespaces, vous pouvez y faire tout ce que vous voulez, et le plus,
 * vous pouvez même communiquer entre différent namespace d'un plugin à l'autre.
 *
 * @since 0.1.0
 * @version 0.1.0
 */
window.eoxiaJS.callManager = {};

/**
 * Initialise l'objet helloWorld dans le namespace eoFrameworkStarter.
 * Permet d'éviter les conflits entre les différents plugins utilisant EO-Framework.
 *
 * Ce fichier JS est une base pour utiliser du JS avec EO-Framework.
 * En lançant la commande "npm start", GULP vas écouter les fichiers *.backend.js et
 * vas s'occuper de les assembler dans le fichier backend.min.js.
 *
 * EO-Framework appel automatiquement la méthode "init" à l'initilisation de certains *pages*
 * du backadmin de WordPress. Ces pages doivent être définis dans le tableau "insert_scripts_page" dans le fichier *.config.json
 * principales de votre plugin.
 * @see https://github.com/Eoxia/task-manager/blob/master/task-manager.config.json pour un exemple
 *
 * @since 0.1.0
 * @version 0.1.0
 */
window.eoxiaJS.callManager.callComment = {};

/**
 * La méthode "init" est appelé automatiquement par la lib JS de Eo-Framework
 *
 * @since 0.1.0
 * @version 0.1.0
 *
 * @return {void}
 */
window.eoxiaJS.callManager.callComment.init = function() {
	jQuery( '.wpeo-wrap iframe' ).css( 'height', jQuery( window ).height() + 'px' );
};

/**
 * Initialise l'objet helloWorld dans le namespace eoFrameworkStarter.
 * Permet d'éviter les conflits entre les différents plugins utilisant EO-Framework.
 *
 * Ce fichier JS est une base pour utiliser du JS avec EO-Framework.
 * En lançant la commande "npm start", GULP vas écouter les fichiers *.backend.js et
 * vas s'occuper de les assembler dans le fichier backend.min.js.
 *
 * EO-Framework appel automatiquement la méthode "init" à l'initilisation de certains *pages*
 * du backadmin de WordPress. Ces pages doivent être définis dans le tableau "insert_scripts_page" dans le fichier *.config.json
 * principales de votre plugin.
 * @see https://github.com/Eoxia/task-manager/blob/master/task-manager.config.json pour un exemple
 *
 * @since 0.1.0
 * @version 0.1.0
 */
window.eoxiaJS.callManager.handleCall = {};

/**
 * La méthode "init" est appelé automatiquement par la lib JS de Eo-Framework
 *
 * @since 0.1.0
 * @version 0.1.0
 *
 * @return {void}
 */
window.eoxiaJS.callManager.handleCall.init = function() {
	jQuery( document ).on( 'click', '.yop form a', window.eoxiaJS.callManager.handleCall.selectUser );
	jQuery( document ).on( 'click', 'li.autocomplete-result', window.eoxiaJS.callManager.handleCall.selectCustomers );
};

window.eoxiaJS.callManager.handleCall.selectUser = function() {
	var dataId = jQuery( this ).attr( 'data-id' );
	jQuery( 'a.active' ).removeClass( 'active' );
	jQuery( this ).addClass( 'active' );
	jQuery( '#yup' ).attr( 'value', dataId );
};

window.eoxiaJS.callManager.handleCall.selectCustomers = function() {
	var custumName = jQuery( this ).attr( 'data-result' );
	var dataId = jQuery( this ).attr( 'data-id' );
	jQuery( '#mon-autocomplete' ).attr( 'value', custumName );
	jQuery( this ).closest( 'div.wpeo-autocomplete' ).removeClass( 'autocomplete-active' );
	jQuery( '#id_cust' ).attr( 'value', dataId );
};
